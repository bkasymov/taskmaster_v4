# Test Configuration 4
#
# This configuration tests:
# 1. Always restart policy
# 2. Unexpected exit restart policy
#
# How to test:
# 1. Start Taskmaster with this configuration
# 2. Check /tmp/always_restart.stdout to see multiple restarts
# 3. For unexpected_only, it should restart on exit code 2, but not on 0 or 1
#    - Check /tmp/unexpected_only.stdout for restarts
#    - You may need to manually start it with different exit codes to test

programs:
  always_restart:
    cmd: "echo 'I will always restart' && exit 1"
    numprocs: 1
    autostart: true
    autorestart: always
    startretries: 3
    starttime: 1
    stoptime: 1
    stdout: /tmp/always_restart.stdout

  unexpected_only:
    cmd: "python3 -c 'import sys; print(sys.argv[1]); exit(int(sys.argv[1]))' 2"
    numprocs: 1
    autostart: true
    autorestart: unexpected
    exitcodes:
      - 0
      - 1
    startretries: 3
    stdout: /tmp/unexpected_only.stdout